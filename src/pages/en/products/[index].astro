---
import * as fs from "fs";
import * as path from "path";
import Papa from "papaparse";
import ProductDetails from "../../../base-pages/ProductDetails.astro";
import t from "../../../i18n/en";

export async function getStaticPaths() {
  const csvPath = path.resolve("./src/data/products_en.csv");
  const csv = fs.readFileSync(csvPath, "utf8");
  const { data: products } = Papa.parse(csv, { header: true });
  return products.filter(p => p.code).map((product) => ({
    params: { index: product.code },
    props: { product },
  }));
}

const { product } = Astro.props;
---
<ProductDetails t={t} product={product} />